
ðŸ“„ core/_google_credentials.py
   â””â”€ def load_credentials()

ðŸ“„ core/google_drive.py
   â””â”€ def get_drive_service()

   â””â”€ def extract_date_from_filename(filename)

   â””â”€ def list_files_in_folder(service, folder_id, mime_type_filter)
   â””â”€ def list_music_files(service, folder_id)

   â””â”€ def get_or_create_folder(parent_folder_id, name, drive_service)
   â””â”€ def get_or_create_subfolder(drive_service, parent_folder_id, subfolder_name)
   â””â”€ def get_file_by_name(drive_service, folder_id, filename)
   â””â”€ def get_all_subfolders(drive_service, parent_folder_id)
   â””â”€ def get_files_in_folder(service, folder_id, name_contains, mime_type, trashed)

   â””â”€ def download_file(service, file_id, destination_path)
   â””â”€ def upload_file(service, filepath, folder_id)
   â””â”€ def upload_to_drive(drive, filepath, parent_id)
   
   â””â”€ def create_spreadsheet(drive_service, name, parent_folder_id, mime_type)
   â””â”€ def move_file_to_folder(drive_service, file_id, folder_id)
   â””â”€ def remove_file_from_root(drive_service, file_id)
   â””â”€ def find_or_create_file_by_name(drive_service, name, parent_folder_id, mime_type)
   

ðŸ“„ core/google_sheets.py
   â””â”€ def get_sheets_service()

   â””â”€ def get_or_create_sheet(spreadsheet_id, sheet_name)
   â””â”€ def read_sheet(spreadsheet_id, range_name)
   â””â”€ def write_sheet(spreadsheet_id, range_name, values)
   â””â”€ def append_rows(spreadsheet_id, range_name, values)
   â””â”€ def log_debug(spreadsheet_id, message)
   â””â”€ def log_info(spreadsheet_id, message)
   â””â”€ def ensure_sheet_exists(spreadsheet_id, sheet_name, headers)
   â””â”€ def get_sheet_metadata(spreadsheet_id)
   â””â”€ def delete_sheet_by_id(spreadsheet_id, sheet_id)
   â””â”€ def update_row(spreadsheet_id, range_, values)
   â””â”€ def sort_sheet_by_column(spreadsheet_id, sheet_name, column_index, ascending, start_row, end_row)
   â””â”€ def get_sheet_id_by_name(sheet_service, spreadsheet_id, sheet_name)
   â””â”€ def get_spreadsheet_metadata(sheets_service, spreadsheet_id)
   â””â”€ def get_sheet_values(sheets_service, spreadsheet_id, sheet_name)
   â””â”€ def rename_sheet(sheets_service, spreadsheet_id, sheet_id, new_title)
   â””â”€ def insert_rows(sheets_service, spreadsheet_id, sheet_name, values)
   â””â”€ def delete_sheet_by_name(sheets_service, spreadsheet_id, sheet_name)
   â””â”€ def write_sheet_data(sheet_service, spreadsheet_id, sheet_name, header, rows)
   â””â”€ def clear_all_except_one_sheet(sheets_service, spreadsheet_id, sheet_to_keep)
   â””â”€ def delete_all_sheets_except(sheets_service, spreadsheet_id, sheet_to_keep)
   â””â”€ def clear_sheet(sheets_service, spreadsheet_id, sheet_name)

ðŸ“„ core/logger.py
   â””â”€ def get_logger()
   â””â”€ def format_date(dt)

ðŸ“„ core/m3u_parsing.py
   â””â”€ def parse_time_str(time_str)
   â””â”€ def extract_tag_value(line, tag)
   â””â”€ def get_most_recent_m3u_file(drive_service)
   â””â”€ def download_m3u_file(drive_service, file_id)
   â””â”€ def parse_m3u_lines(lines, existing_keys, file_date_str)
   â””â”€ def parse_m3u(sheets_service, filepath, spreadsheet_id)

ðŸ“„ core/sheets_formatting.py
   â””â”€ def apply_sheet_formatting(sheet)
   â””â”€ def apply_formatting_to_sheet(spreadsheet_id)
   â””â”€ def set_values(sheets_service, spreadsheet_id, sheet_name, start_row, start_col, values)
   â””â”€ def set_bold_font(sheets_service, spreadsheet_id, sheet_id, start_row, end_row, start_col, end_col)
   â””â”€ def freeze_rows(sheets_service, spreadsheet_id, sheet_id, num_rows)
   â””â”€ def set_horizontal_alignment(sheets_service, spreadsheet_id, sheet_id, start_row, end_row, start_col, end_col, alignment)
   â””â”€ def set_number_format(sheets_service, spreadsheet_id, sheet_id, start_row, end_row, start_col, end_col, format_str)
   â””â”€ def auto_resize_columns(sheets_service, spreadsheet_id, sheet_id, start_col, end_col)
   â””â”€ def update_sheet_values(sheets_service, spreadsheet_id, sheet_name, values)
   â””â”€ def set_sheet_formatting(spreadsheet_id, sheet_id, header_row_count, total_rows, total_cols, backgrounds)
   â””â”€ def set_column_formatting(sheets_service, spreadsheet_id, sheet_name, num_columns)
   â””â”€ def reorder_sheets(sheets_service, spreadsheet_id, sheet_names_in_order, spreadsheet_metadata)
   â””â”€ def format_summary_sheet(sheet_service, spreadsheet_id, sheet_name, header, rows)

ðŸ“„ core/spotify.py
   â””â”€ def get_spotify_client_from_refresh()
   â””â”€ def search_track(artist, title)
   â””â”€ def add_tracks_to_playlist(uris)
   â””â”€ def trim_playlist_to_limit(limit)
   â””â”€ def get_cached_token(self) [UNUSED]
   â””â”€ def save_token_to_cache(self, token_info) [UNUSED]

ðŸ“„ tools/dj_set_processor/dj_set_collection.py
   â””â”€ def generate_dj_set_collection()

ðŸ“„ tools/dj_set_processor/generate_summaries.py
   â””â”€ def generate_next_missing_summary()
   â””â”€ def generate_summary_for_folder(drive_service, sheet_service, files, summary_folder_id, summary_name, year)
   â””â”€ def generate_complete_summary()
   â””â”€ def main()

ðŸ“„ tools/dj_set_processor/helpers.py
   â””â”€ def get_shared_filled_fields(data1, data2, indices)
   â””â”€ def get_dedup_match_score(data1, data2, indices)
   â””â”€ def string_similarity(a, b)
   â””â”€ def clean_title(title)
   â””â”€ def hex_to_rgb(hex_color)
   â””â”€ def try_lock_folder(folder_name)
   â””â”€ def release_folder_lock(folder_name)
   â””â”€ def _try_lock_folder(folder_name) [UNUSED]
   â””â”€ def _release_folder_lock(folder_name) [UNUSED]
   â””â”€ def _clean_title(value) [UNUSED]
   â””â”€ def levenshtein_distance(a, b)
   â””â”€ def _string_similarity(a, b) [UNUSED]
   â””â”€ def _get_shared_filled_fields(row_a, row_b, dedup_indices) [UNUSED]
   â””â”€ def _get_dedup_match_score(row_a, row_b, dedup_indices) [UNUSED]
   â””â”€ def get_or_create_subfolder(parent, name)
   â””â”€ def extract_date_and_title(file_name)

ðŸ“„ tools/dj_set_processor/process_new_csv_files.py
   â””â”€ def extract_year_from_filename(filename)
   â””â”€ def normalize_csv(file_path)
   â””â”€ def normalize_prefixes_in_source(drive)
   â””â”€ def main()

ðŸ“„ tools/live_music_history/update_recent_history.py
   â””â”€ def build_youtube_links(entries)
   â””â”€ def write_entries_to_sheet(sheets_service, entries, now)
   â””â”€ def read_existing_entries(sheets_service, cutoff)
   â””â”€ def update_last_run_time(sheets_service, now)
   â””â”€ def publish_history(drive_service, sheets_service)

ðŸ“„ tools/music_tag_sort/main.py
   â””â”€ def main()
   â””â”€ def process_drive_folder()

ðŸ“„ tools/music_tag_sort/renamer.py
   â””â”€ def new_sanitize_filename(value) [UNUSED]
   â””â”€ def sanitize_filename(value)
   â””â”€ def get_metadata(file_path)
   â””â”€ def rename_music_file(file_path, output_dir)
   â””â”€ def rename_files_in_directory(directory, config)
   â””â”€ def generate_filename(metadata, config)

ðŸ“„ tools/westie_radio/sync.py
   â””â”€ def initialize_spreadsheet()
   â””â”€ def main()